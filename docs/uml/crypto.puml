@startuml crypto
!include .stylesheet.puml

left footer WFJL Crypto Class Diagram

package org.whiteflagprotocol.java.crypto {
    class WfCipher {
        +setContext(byte[])
        +setInitVector(byte[])
        +encrypt(String) : String
        +decrypt(String) : String
    }
    enum WfAuthenticationMethod {
        +TOKEN_PRESHARED
    }
    class WfAuthToken {
        +getVerificationData() : String
    }
    enum WfEncryptionMethod {
        +AES_256_CTR_PSK
        +AES_256_CTR_ECDH
    }
    class WfEncryptionKey {
        +getEncryptionMethod() : WfEncryptionMethod
        +getSecretKey() : byte[]
    }
    class WfECDHKeyPair {
        +getPublicKey() : byte[]
        +getSharedKey(byte[]): byte[]
    }
    class WfCryptoUtil <<Utility>> {
        +parseHexString(String) : byte[]
        +toHexString(byte[]) : String
        +hkdf() : byte[]
        +hkdfExtract() : byte[]
        +hkdfExpand() : byte[]
    }
}

WfCipher ..> WfEncryptionKey
WfEncryptionKey --- WfEncryptionMethod
WfAuthToken --- WfAuthenticationMethod
WfEncryptionKey ..> WfCryptoUtil
WfEncryptionKey ..> WfECDHKeyPair
WfAuthToken ..> WfCryptoUtil

@enduml